{% extends "articles/layout.html" %}

{% block title %}{%- if tag_name -%}{{ _('views.articles.index.title_tag') % tag_name }}{%- else -%}{{ _('articles') }}{%- endif %}{% endblock %}

{% block content_body %}
<div class="page-header">
    {% if require_roles('admin', 'root') %}
    <a href="{{ url_for('articles.create') }}" class="btn btn-success pull-right">{{ _('articles.create') }}</a>
    {% endif %}
    <h1>{{ self.title() }}</h1>
</div>

<ul class="article-list">
    {% for article in articles.items %}
    <li class="article article-{{ article.id }}">
        <div class="article-head">
            <a href="{{ url_for('.show', article_id=article.id) }}"><h3>{{ article.title }}</h3></a>
            <div class="article-meta">
                <span><i class="icon icon-time"></i> {{ article.created_time | dateformat }}</span>
                <span><i class="icon icon-user"></i> {{ article.author.nickname }}</span>
                {% if article.tags %}
                <span><i class="icon icon-tags"></i> 
                    {% for tag in article.tags %}
                    <a class="label" href="{{ url_for('.index', tag_name=tag.name) }}">{{ tag.name }}</a>
                    {% endfor %}
                </span>
                {% endif %}
            </div>
        </div>
        <div class="article-content">
            {{ article.content_html | safe }}
        </div>
        <hr />
    </li>
    {% endfor %}
</ul>

{% if articles.items %}
{{ p.render_pagination(articles, 'articles.index') }}
{% else %}
<div class="alert alert-info">{{ _('messages.no_record') % _('articles') }}</div>
{% endif %}

{% endblock %}
